<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Map Viewer</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
    <style>
        html, body, #map {
            height: 100%;
            margin: 0;
        }

        .smart-popup {
            font-family: Arial, sans-serif;
            font-size: 12px;
        }

        .popup-content {
            text-align: center;
            width: 200px;
        }

        .popup-header {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .popup-img {
            width: 200px;
            height: 150px;
            object-fit: cover;
            margin-top: 5px;
        }

        .popup-coords {
            color: #333;
            font-size: 11px;
            margin-top: 4px;
        }
    </style>
</head>
<body>
    <div id="map"></div>

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
        // Ganti ini dengan data geoJSON kamu
        const geoJSONData = {
            "type": "FeatureCollection",
            "features": [
                {
                    "type": "Feature",
                    "properties": {
                        "ID": "001",
                        "lat": "-5.2893",
                        "lon": "105.4231",
                        "foto_path": "https://placehold.co/200x150?text=Image+001",
                        "foto_name": "Image001.jpg"
                    },
                    "geometry": {
                        "type": "Point",
                        "coordinates": [105.4231, -5.2893]
                    }
                }
                // Tambahkan fitur lainnya di sini...
            ]
        };

        const map = L.map('map');

        const plantIcon = L.divIcon({
            className: 'custom-div-icon',
            html: "<div style='background: transparent; border: 2px solid green; border-radius: 50%; width: 10px; height: 10px;'></div>",
            iconSize: [10, 10],
            iconAnchor: [5, 5]
        });

        const geoJsonLayer = L.geoJSON(geoJSONData, {
            pointToLayer: function(feature, latlng) {
                const marker = L.marker(latlng, {
                    icon: plantIcon,
                    opacity: 1
                });

                const popupContent = `
                    <div class="popup-content">
                        <div class="popup-header">ID ${feature.properties.ID}</div>
                        <div class="popup-coords">
                            ${feature.properties.lat}<br>
                            ${feature.properties.lon}
                        </div>
                        <img class="popup-img" 
                             src="${feature.properties.foto_path}" 
                             onerror="this.src='https://placehold.co/200x150?text=No+Image'" 
                             alt="${feature.properties.foto_name}">
                    </div>
                `;

                marker.bindPopup(popupContent, {
                    autoPan: true,
                    autoPanPadding: [50, 50],
                    maxWidth: 250,
                    minWidth: 200,
                    className: 'smart-popup'
                });

                marker.on('click', function() {
                    marker.openPopup();
                });

                return marker;
            }
        }).addTo(map);

        // Auto-center the map to fit all markers
        map.fitBounds(geoJsonLayer.getBounds());

        // Optional: add a tile layer
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap contributors'
        }).addTo(map);
    </script>
</body>
</html>
